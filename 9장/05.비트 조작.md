# 05.비트조작
비트조작 코드를 작성하는 능력 뿐만 아니라 손으로도 그릴 수 있어야함

## 비트 조작을 할 때 알아야 할 사실들과 트릭들
- 외우지 말고 이해할 것
- 1s는 모두 1, 0s는 모두 0
x ^ 0s = x      x & 0s = 0      x | 0s = x
x ^ 1s = ~x     x & 1s = x      x | 1s = 1s
x ^ x = 0       x & x = x       x | x = x

## 2의 보수와 음수
- 음수를 표현할 때, 수의 절댓값에 부호비트를 1로 세팅한 뒤 2의 보수를 취한 형태로 표현
- -K를 N비트의 2진수로 표현: concat(1, 2**(N-1) - K)
- 양수로 표현된 2진수를 뒤집은 뒤 1을 더해줌

## 산술 우측 시프트 vs 논리 우측 시프트
### 논리 우측 시프트
```javascript
-1 >>> 1
// = 2147483647
```
비트를 옆으로 옮긴 다음

최상위 비트에 0을 넣는다

1|0|1|1|0|1|0|1
-|-|-|-|-|-|-|-
0|1|0|1|1|0|1|0

길이만큼 시프트를 하면 0이 된다.

0|0|0|0|0|0|0|0
-|-|-|-|-|-|-|-

### 산술 우측 시프트
```javascript
-1 >> 1
// = -1
```
비트를 오른쪽으로 옮기지만

부호비트를 바꾸지 않는다

1|0|1|1|0|1|0|1
-|-|-|-|-|-|-|-
1|1|0|1|1|0|1|0

길이만큼 시프트를 하면 -1이 된다.

1|1|1|1|1|1|1|1
-|-|-|-|-|-|-|-

### 좌측 시프트는 구분이 없다
```javascript
1 << 1 // 2
```
※ '<<<'는 없는 문법임

## 기본적인 비트 조작: 비트값 확인 및 채워넣기

다음의 연산들은 중요하므로 반드시 이해하고 있어야한다.

### i번째 비트값 확인

```java
boolean getBit(int num, int i) {
    return (num & (1 << i) != 0);
}
```
1. 1을 i비트만큼 시프트해서 값을 만듬(ex: 00010000)
2. AND연산을 통해 num에 있는 i번째 비트말고 다 0으로 만듬
3. 값이 0이 아니면 true

### 비트값 채워넣기
```java
int setBit(int num, int i) {
    return num | (1 << i);
}
```
1. 1을 i비트만큼 시프트해서 값을 만듬(ex: 00010000)
2. OR연산을 통해 i번째 비트를 바꿈
3. 나머지 비트들은 0과 OR연산을 하게되므로 영향이 없다

### 비트값 삭제하기
#### i번째 비트 삭제
```java
int clearBit(int num, int i) {
    int mask = ~(1 << i);
    return num & mask;
}
```
1. 1을 i비트만큼 시프트후 NOT연산자를 이용해 값을 만듬(ex: 11101111)
2. 해당 값과 num을 AND연산
3. i번째 비트만 0과 AND 연산을 하므로 0으로 바뀜

#### 최상위에서 i번째 비트 삭제
```java
int clearBitsMSBthroughtI(int num, int i) {
    int mask = (1 << i) - 1;
}
```
1. (1 << i)로 i번째 비트를 1로 세팅하고 1을 뺌
2. mask는 i번째 비트 밑은 모두 1이고 그위로는 0이 됨
3. mask값과 num을 AND 연산하면 완료

#### i번째 비트에서 0번째 비트까지 모두 삭제
```java
int clearBitsIthrough0(int num, int i) {
    int mask = (-1 << (i + 1));
    return num & mask;
}
```
1. 모든비트가 1인 -1을 i+1 만큼 시프트함
2. mask i번째 비트 위로는 모두 1로 새팅되고 하위는 0이 됨
3. mask값과 num을 AND 연산하면 완료

### 비트값 바꾸기
```java
int updateBit(int num, int i, boolean bitIs1) {
    int value = bitIs1 ? 1 : 0;
    int mask = ~(1 << i);
    return (num & mask) | (value << i);
}
```
1. 11101111과 같은 값을 생성
2. AND 연산을 통해 i번째 값 제거
3. 바꾸고자하는 값 v를 i만큼 시프트
4. OR 연산을 통해 원하는 값으로 변경

## 5.7 쌍끼리 맞바꾸기:
명령어를 가능한 한 적게 사용해서 주어진 정수의 짝수 번째 비트의 값과 홀수 번째 비트의 값을 바꾸는 프로그램을 작성하라.
(예: 0번째 비트와 1번째 비트를 바꾸고, 2번째 비트와 3번째 비트를 바꾸는 식으로).

```javascript
function solution(n) {
    let odd = n & 0x55555555;
    let even = n & 0xaaaaaaaa;

    odd = odd << 1;
    even = even >> 1;

    return odd | even;
}
```

1. mask: 0101...010101로 홀수만 남기고, 짝수도 비슷하게
2. 홀수는 왼쪽으로 시프트, 짝수는 오른쪽으로 시프트
3. 홀수와 짝수를 OR 연산으로 합치면 답이 나옴

